webpackJsonp([2],[,,function(e,t,n){"use strict";(function(e){n(12);var t=n(1),r=function(e){return e&&e.__esModule?e:{default:e}}(t);n(3);n(11),e(document).ready(function(){function t(){console.log("退出");var e=function(){ajax("loginout","https://nx.smsc.net.cn/wxopen/app/shop/logout.php/").then(function(e){console.log("退出登录成功！",e)})};return r.default.myLayerTips("是否退出？",e,"取消","确定")}e("#loginout").on("click",t)})}).call(t,n(0))},function(e,t,n){"use strict";function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function s(e,t,n){if(e&&h.isObject(e)&&e instanceof r)return e;var s=new r;return s.parse(e,t,n),s}function a(e){return h.isString(e)&&(e=s(e)),e instanceof r?e.format():r.prototype.format.call(e)}function i(e,t){return s(e,!1,!0).resolve(t)}function o(e,t){return e?s(e,!1,!0).resolveObject(t):t}var l=n(4),h=n(7);t.parse=s,t.resolve=i,t.resolveObject=o,t.format=a,t.Url=r;var c=/^([a-z0-9.+-]+:)/i,d=/:[0-9]*$/,p=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,u=["<",">",'"',"`"," ","\r","\n","\t"],m=["{","}","|","\\","^","`"].concat(u),f=["'"].concat(m),v=["%","/","?",";","#"].concat(f),y=["/","?","#"],k=/^[+a-z0-9A-Z_-]{0,63}$/,b=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,g={javascript:!0,"javascript:":!0},w={javascript:!0,"javascript:":!0},x={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},C=n(8);r.prototype.parse=function(e,t,n){if(!h.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var r=e.indexOf("?"),s=-1!==r&&r<e.indexOf("#")?"?":"#",a=e.split(s),i=/\\/g;a[0]=a[0].replace(i,"/"),e=a.join(s);var o=e;if(o=o.trim(),!n&&1===e.split("#").length){var d=p.exec(o);if(d)return this.path=o,this.href=o,this.pathname=d[1],d[2]?(this.search=d[2],this.query=t?C.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var u=c.exec(o);if(u){u=u[0];var m=u.toLowerCase();this.protocol=m,o=o.substr(u.length)}if(n||u||o.match(/^\/\/[^@\/]+@[^@\/]+/)){var L="//"===o.substr(0,2);!L||u&&w[u]||(o=o.substr(2),this.slashes=!0)}if(!w[u]&&(L||u&&!x[u])){for(var O=-1,I=0;I<y.length;I++){var T=o.indexOf(y[I]);-1!==T&&(-1===O||T<O)&&(O=T)}var j,_;_=-1===O?o.lastIndexOf("@"):o.lastIndexOf("@",O),-1!==_&&(j=o.slice(0,_),o=o.slice(_+1),this.auth=decodeURIComponent(j)),O=-1;for(var I=0;I<v.length;I++){var T=o.indexOf(v[I]);-1!==T&&(-1===O||T<O)&&(O=T)}-1===O&&(O=o.length),this.host=o.slice(0,O),o=o.slice(O),this.parseHost(),this.hostname=this.hostname||"";var A="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!A)for(var S=this.hostname.split(/\./),I=0,D=S.length;I<D;I++){var E=S[I];if(E&&!E.match(k)){for(var z="",M=0,q=E.length;M<q;M++)E.charCodeAt(M)>127?z+="x":z+=E[M];if(!z.match(k)){var U=S.slice(0,I),W=S.slice(I+1),N=E.match(b);N&&(U.push(N[1]),W.unshift(N[2])),W.length&&(o="/"+W.join(".")+o),this.hostname=U.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),A||(this.hostname=l.toASCII(this.hostname));var R=this.port?":"+this.port:"",H=this.hostname||"";this.host=H+R,this.href+=this.host,A&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==o[0]&&(o="/"+o))}if(!g[m])for(var I=0,D=f.length;I<D;I++){var P=f[I];if(-1!==o.indexOf(P)){var F=encodeURIComponent(P);F===P&&(F=escape(P)),o=o.split(P).join(F)}}var $=o.indexOf("#");-1!==$&&(this.hash=o.substr($),o=o.slice(0,$));var B=o.indexOf("?");if(-1!==B?(this.search=o.substr(B),this.query=o.substr(B+1),t&&(this.query=C.parse(this.query)),o=o.slice(0,B)):t&&(this.search="",this.query={}),o&&(this.pathname=o),x[m]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var R=this.pathname||"",K=this.search||"";this.path=R+K}return this.href=this.format(),this},r.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",s=!1,a="";this.host?s=e+this.host:this.hostname&&(s=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(s+=":"+this.port)),this.query&&h.isObject(this.query)&&Object.keys(this.query).length&&(a=C.stringify(this.query));var i=this.search||a&&"?"+a||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||x[t])&&!1!==s?(s="//"+(s||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):s||(s=""),r&&"#"!==r.charAt(0)&&(r="#"+r),i&&"?"!==i.charAt(0)&&(i="?"+i),n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),i=i.replace("#","%23"),t+s+n+i+r},r.prototype.resolve=function(e){return this.resolveObject(s(e,!1,!0)).format()},r.prototype.resolveObject=function(e){if(h.isString(e)){var t=new r;t.parse(e,!1,!0),e=t}for(var n=new r,s=Object.keys(this),a=0;a<s.length;a++){var i=s[a];n[i]=this[i]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var o=Object.keys(e),l=0;l<o.length;l++){var c=o[l];"protocol"!==c&&(n[c]=e[c])}return x[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!x[e.protocol]){for(var d=Object.keys(e),p=0;p<d.length;p++){var u=d[p];n[u]=e[u]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||w[e.protocol])n.pathname=e.pathname;else{for(var m=(e.pathname||"").split("/");m.length&&!(e.host=m.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==m[0]&&m.unshift(""),m.length<2&&m.unshift(""),n.pathname=m.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var f=n.pathname||"",v=n.search||"";n.path=f+v}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var y=n.pathname&&"/"===n.pathname.charAt(0),k=e.host||e.pathname&&"/"===e.pathname.charAt(0),b=k||y||n.host&&e.pathname,g=b,C=n.pathname&&n.pathname.split("/")||[],m=e.pathname&&e.pathname.split("/")||[],L=n.protocol&&!x[n.protocol];if(L&&(n.hostname="",n.port=null,n.host&&(""===C[0]?C[0]=n.host:C.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===m[0]?m[0]=e.host:m.unshift(e.host)),e.host=null),b=b&&(""===m[0]||""===C[0])),k)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,C=m;else if(m.length)C||(C=[]),C.pop(),C=C.concat(m),n.search=e.search,n.query=e.query;else if(!h.isNullOrUndefined(e.search)){if(L){n.hostname=n.host=C.shift();var O=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");O&&(n.auth=O.shift(),n.host=n.hostname=O.shift())}return n.search=e.search,n.query=e.query,h.isNull(n.pathname)&&h.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!C.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var I=C.slice(-1)[0],T=(n.host||e.host||C.length>1)&&("."===I||".."===I)||""===I,j=0,_=C.length;_>=0;_--)I=C[_],"."===I?C.splice(_,1):".."===I?(C.splice(_,1),j++):j&&(C.splice(_,1),j--);if(!b&&!g)for(;j--;j)C.unshift("..");!b||""===C[0]||C[0]&&"/"===C[0].charAt(0)||C.unshift(""),T&&"/"!==C.join("/").substr(-1)&&C.push("");var A=""===C[0]||C[0]&&"/"===C[0].charAt(0);if(L){n.hostname=n.host=A?"":C.length?C.shift():"";var O=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");O&&(n.auth=O.shift(),n.host=n.hostname=O.shift())}return b=b||n.host&&C.length,b&&!A&&C.unshift(""),C.length?n.pathname=C.join("/"):(n.pathname=null,n.path=null),h.isNull(n.pathname)&&h.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},r.prototype.parseHost=function(){var e=this.host,t=d.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,n){(function(e,r){var s;!function(a){function i(e){throw new RangeError(D[e])}function o(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function l(e,t){var n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),e=e.replace(S,"."),r+o(e.split("."),t).join(".")}function h(e){for(var t,n,r=[],s=0,a=e.length;s<a;)t=e.charCodeAt(s++),t>=55296&&t<=56319&&s<a?(n=e.charCodeAt(s++),56320==(64512&n)?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),s--)):r.push(t);return r}function c(e){return o(e,function(e){var t="";return e>65535&&(e-=65536,t+=M(e>>>10&1023|55296),e=56320|1023&e),t+=M(e)}).join("")}function d(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:w}function p(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function u(e,t,n){var r=0;for(e=n?z(e/O):e>>1,e+=z(e/t);e>E*C>>1;r+=w)e=z(e/E);return z(r+(E+1)*e/(e+L))}function m(e){var t,n,r,s,a,o,l,h,p,m,f=[],v=e.length,y=0,k=T,b=I;for(n=e.lastIndexOf(j),n<0&&(n=0),r=0;r<n;++r)e.charCodeAt(r)>=128&&i("not-basic"),f.push(e.charCodeAt(r));for(s=n>0?n+1:0;s<v;){for(a=y,o=1,l=w;s>=v&&i("invalid-input"),h=d(e.charCodeAt(s++)),(h>=w||h>z((g-y)/o))&&i("overflow"),y+=h*o,p=l<=b?x:l>=b+C?C:l-b,!(h<p);l+=w)m=w-p,o>z(g/m)&&i("overflow"),o*=m;t=f.length+1,b=u(y-a,t,0==a),z(y/t)>g-k&&i("overflow"),k+=z(y/t),y%=t,f.splice(y++,0,k)}return c(f)}function f(e){var t,n,r,s,a,o,l,c,d,m,f,v,y,k,b,L=[];for(e=h(e),v=e.length,t=T,n=0,a=I,o=0;o<v;++o)(f=e[o])<128&&L.push(M(f));for(r=s=L.length,s&&L.push(j);r<v;){for(l=g,o=0;o<v;++o)(f=e[o])>=t&&f<l&&(l=f);for(y=r+1,l-t>z((g-n)/y)&&i("overflow"),n+=(l-t)*y,t=l,o=0;o<v;++o)if(f=e[o],f<t&&++n>g&&i("overflow"),f==t){for(c=n,d=w;m=d<=a?x:d>=a+C?C:d-a,!(c<m);d+=w)b=c-m,k=w-m,L.push(M(p(m+b%k,0))),c=z(b/k);L.push(M(p(c,0))),a=u(n,y,r==s),n=0,++r}++n,++t}return L.join("")}function v(e){return l(e,function(e){return _.test(e)?m(e.slice(4).toLowerCase()):e})}function y(e){return l(e,function(e){return A.test(e)?"xn--"+f(e):e})}var k=("object"==typeof t&&t&&t.nodeType,"object"==typeof e&&e&&e.nodeType,"object"==typeof r&&r);var b,g=2147483647,w=36,x=1,C=26,L=38,O=700,I=72,T=128,j="-",_=/^xn--/,A=/[^\x20-\x7E]/,S=/[\x2E\u3002\uFF0E\uFF61]/g,D={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},E=w-x,z=Math.floor,M=String.fromCharCode;b={version:"1.4.1",ucs2:{decode:h,encode:c},decode:m,encode:f,toASCII:y,toUnicode:v},void 0!==(s=function(){return b}.call(t,n,t,e))&&(e.exports=s)}()}).call(t,n(5)(e),n(6))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,n){"use strict";t.decode=t.parse=n(9),t.encode=t.stringify=n(10)},function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,a){t=t||"&",n=n||"=";var i={};if("string"!=typeof e||0===e.length)return i;var o=/\+/g;e=e.split(t);var l=1e3;a&&"number"==typeof a.maxKeys&&(l=a.maxKeys);var h=e.length;l>0&&h>l&&(h=l);for(var c=0;c<h;++c){var d,p,u,m,f=e[c].replace(o,"%20"),v=f.indexOf(n);v>=0?(d=f.substr(0,v),p=f.substr(v+1)):(d=f,p=""),u=decodeURIComponent(d),m=decodeURIComponent(p),r(i,u)?s(i[u])?i[u].push(m):i[u]=[i[u],m]:i[u]=m}return i};var s=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){"use strict";function r(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var s=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,o){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?r(i(e),function(i){var o=encodeURIComponent(s(i))+n;return a(e[i])?r(e[i],function(e){return o+encodeURIComponent(s(e))}).join(t):o+encodeURIComponent(s(e[i]))}).join(t):o?encodeURIComponent(s(o))+n+encodeURIComponent(s(e)):""};var a=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},i=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";(function(e){function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();n(2);var s=n(1),a=function(e){return e&&e.__esModule?e:{default:e}}(s);n(38);e(document).ready(function(){var n=function(){function e(n,r){t(this,e),this.tableList=n,this.tableWeek=r,this.checkObj={},this.canOderId="",this.currentTime=30,this.storeList=[],this.isOrderStore=!1,this.storeLookId=new Set,this.empLookId=new Set,this.orderAllData=[]}return r(e,[{key:"getOrder",value:function(){this.showOrder()}},{key:"showOrder",value:function(){this.cancel()}}]),e}();n.prototype.getDoctorList=function(){var t=this,n=(layer.load(2),this);ajax(Api("getEmpList")).then(function(r){var s="",i=r.data,o=i.length;if(t.doctorList=i,o>0){s+="<thead><tr> <th>序号</th><th>员工姓名</th><th>编辑排班</th> </tr > </thead><tbody>";for(var l=0;l<o;l++){var h=i[l];s+="\n                        <tr>\n                            <td>"+(l+1)+"</td>\n                            <td>"+h.name+"</td>",s+='\n                            <td> \n                                <input type="hidden" value="'+h.id+'">\n                                <button class="btn btn-warning" id="order-week-btn">按周排班</button>\n                                <button class="btn btn-danger" id="order-month-btn" style="margin-left:20px;">按天排班</button>\n                            </td>\n                        </tr>\n                        '}s+="</tbody>"}else s="<p>暂无数据！</p>";a.default.addHtml(t.tableList,s);var c=function(){e(".order-week-table").empty(),n.currentId=e(this).parent().children("input").val(),n.selectList("week")},d=function(){e(".order-week-table").empty(),n.currentId=e(this).parent().children("input").val(),n.selectList("month")};t.tableList.unbind("click"),t.tableList.on("click","#order-week-btn",c),t.tableList.on("click","#order-month-btn",d)}).then(function(){setTimeout(function(){layer.close(layer.index)},100)})},n.prototype.lookOrder=function(){function t(){for(var t="",n="",r=0;r<s.doctorList.length;r++){var i=s.doctorList[r];t+='<li class="fl" data-id="'+i.id+'"><i class="iconfont icon-weixuanze"></i> <span>'+i.name+"</span></li>"}for(var o=0;o<s.storeList.length;o++){var l=s.storeList[o];n+='<li class="fl" data-id="'+l.id+'"><i class="iconfont icon-weixuanze"></i> <span>'+l.name+"</span></li>"}a.default.addHtml(e(".look-emp-list ul"),t),a.default.addHtml(e(".look-store-list ul"),n)}function n(t,n,s,i,o,l){t.addClass("btn-primary"),n.removeClass("btn-primary"),a.default.toggleClass(s),o.clear(),l.clear(),a.default.addClass(e(s[0])),l.add(e(s[0]).attr("data-id"));for(var h=0;h<i.length;h++){var c=e(i[h]);a.default.addClass(c),o.add(c.attr("data-id"))}r()}function r(){if(s.orderAllData.date.length>0){for(var e=s.orderAllData.date,t=s.orderAllData.rest,n=Array.from(s.empLookId),r=Array.from(s.storeLookId),i=[],o={},l=0;l<e.length;l++){var h=e[l];if(s.isOrderStore)for(var c=0;c<n.length;c++){var d=n[c];h.empid==d&&r[0]==h.storeid&&(o[h.date]||(o[h.date]={},o[h.date].am=[],o[h.date].pm=[]),o[h.date].day=h.date,"1"==h.day&&o[h.date].am.push({id:h.empid,name:h.empname,orderTimes:h.orderTimes}),"2"==h.day&&o[h.date].pm.push({id:h.empid,name:h.empname,orderTimes:h.orderTimes}))}else for(var p=0;p<n.length;p++){var u=n[p];if(u==h.empid){for(var m=0;m<r.length;m++){var f=r[m];if(h.storeid==f||"-1"==h.storeid){o[h.date]||(o[h.date]={}),o[h.date].day=h.date,"1"==h.day&&(o[h.date].am={},o[h.date].am.id=h.storeid,o[h.date].am.name=h.storename,o[h.date].am.orderTimes=h.orderTimes),"2"==h.day&&(o[h.date].pm={},o[h.date].pm.id=h.storeid,o[h.date].pm.name=h.storename,o[h.date].pm.orderTimes=h.orderTimes);break}}break}}}for(var v in o)if(o.hasOwnProperty(v)){for(var y=o[v],k=0;k<t.length;k++){var b=t[k];s.isOrderStore?v==b.date&&b.storeid==r[0]&&(y.rest="-2"):(y.am&&v==b.date&&b.storeid==y.am.id&&(y.am.id="-2"),y.pm&&v==b.date&&b.storeid==y.pm.id&&(y.pm.id="-2"))}i.push(y)}s.isOrderStore?s.renderMonthHtml(0,s.currentTime,i,"look-order-table",!0):s.renderMonthHtml(0,s.currentTime,i,"look-order-table")}else a.default.myLayer("没有排班数据！",2)}var s=this;e(".look-order-back").on("click",function(){e("#order-look").hide(),e("#edit-order-warp").show(),e(this).hide(),e(".look-order-class").show()}),e(".look-order-class").on("click",function(){console.log("look order"),e("#order-look").show(),e("#edit-order-warp").hide(),e(".look-order-back").show(),e(this).hide(),s.isOrderStore=!1,0==s.storeList.length?ajax(Api("getStoreList")).then(function(e){e?(s.storeList=e.data,t()):a.default.myLayer("门店列表数据错误",2)}):t(),ajax(Api("workTime")).then(function(t){t?(s.orderAllData=t.data,e(".edit-people-class").trigger("click")):a.default.myLayer("获取排班数据错误",2)})}),e(".look-emp-list ul").on("click","li",function(){var t=e(this),n=t.attr("data-id");if(s.isOrderStore)return a.default.toggleClassName(t),s.empLookId.has(n)?s.empLookId.delete(n):s.empLookId.add(n),r(),!1;s.empLookId.clear(),s.empLookId.add(n),s.changeCheckedClass(t),r()}),e(".look-store-list ul").on("click","li",function(){var t=e(this),n=t.attr("data-id");if(!s.isOrderStore)return a.default.toggleClassName(t),s.storeLookId.has(n)?s.storeLookId.delete(n):s.storeLookId.add(n),r(),!1;s.storeLookId.clear(),s.storeLookId.add(n),s.changeCheckedClass(t),r()}),e(".edit-order-class").on("click",function(){s.isOrderStore=!0,n(e(this),e(".edit-people-class"),e(".look-store-list li"),e(".look-emp-list li"),s.empLookId,s.storeLookId)}),e(".edit-people-class").on("click",function(){s.isOrderStore=!1,n(e(this),e(".edit-order-class"),e(".look-emp-list li"),e(".look-store-list li"),s.storeLookId,s.empLookId)}),e(".look-15-class").on("click",function(){s.currentTime=15,e(this).addClass("btn-primary"),e(".look-30-class").removeClass("btn-primary"),e(".look-60-class").removeClass("btn-primary"),r()}),e(".look-30-class").on("click",function(){s.currentTime=30,e(this).addClass("btn-primary"),e(".look-15-class").removeClass("btn-primary"),e(".look-60-class").removeClass("btn-primary"),r()}),e(".look-60-class").on("click",function(){s.currentTime=60,e(this).addClass("btn-primary"),e(".look-30-class").removeClass("btn-primary"),e(".look-15-class").removeClass("btn-primary"),r()})},n.prototype.cancel=function(){this.tableList.show(),this.tableWeek.hide(),this.checkObj={},this.canOderId="",this.currentTime=30,e(".look-order-class").show(),e(".save-order-time").unbind("click"),e(".cancel-order-time").unbind("click"),e(".order-week-modal-on").unbind("click"),e("#order-week").unbind("click")},n.prototype.selectList=function(t){function n(){o.cancel()}function r(){s(!1)}function s(){for(var n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=e(".order-week-table td"),s=[],a=0;a<r.length;a++){var i=r[a],l=e(i).children(".day"),h=e(i).children(".am").children(".content").attr("id"),c=e(i).children(".pm").children(".content").attr("id"),d=e(i).children(".am").children(".content").text(),p=e(i).children(".pm").children(".content").text(),u=e(i).children(".am").children("em").attr("data-id"),m=e(i).children(".pm").children("em").attr("data-id");if(h||c){var f={};f.am={},f.pm={},f.am.id=h||"",f.pm.id=c||"",f.am.name=d||"",f.pm.name=p||"",f.am.orderTimes=u||"",f.pm.orderTimes=m||"",f[l.attr("name")]=l.text(),s.push(f)}}return n||o.toSaveOrder(s,t),s}function a(e){o.setSingleOrder(e)}var i=this;this.currentTime=30,e(".look-order-class").hide();for(var o=this,l=0;l<this.doctorList.length;l++){var h=this.doctorList[l];if(h.id===this.currentId){this.name=h.name;break}}layer.load(2);ajax(Api("getEmp",{empid:this.currentId})).then(function(e){i.tableList.hide(),i.tableWeek.show();var n="",r=e.data.typeRoles;if(r.length>0){n+='\n                    <h3><em style="font-size:18px;">当前员工：</em>'+i.name+'</em></h3>\n                    <div class="clearfix store-list-warp">\n                        <h4 class="fl" style="margin:5px;margin-top:16px;">门店列表：</h4>\n                        <ul class="clearfix store-lists fl">\n                ';for(var s="",a=0;a<r.length;a++){var o=r[a].storeId;0===a?("week"!==t&&(n+='\n                                <li class="fl red"><i class="iconfont icon-weixuanze"></i> <span data-id="-1">不出诊</span></li>\n                            '),n+='<li class="fl checked"><i class="iconfont icon-yixuanze"></i> <span data-id="'+o.id+'">'+o.name+"</span></li>",i.checkObj.id=o.id,i.checkObj.name=o.name,s=o.name):n+='<li class="fl"><i class="iconfont icon-weixuanze"></i> <span data-id="'+o.id+'">'+o.name+"</span></li>"}n+="</ul></div>";var l=[1,2,3,4,5,6,7,8,9,10];n+='<div class="clearfix order-date-warp">\n                <h4 class="fl" style="margin:5px;margin-top:16px;">可预约次数：</h4>\n                <ul class="order-date clearfix fl">';for(var h=0;h<l.length;h++){var c=l[h];3==c?(i.canOderId=3,n+='<li class="fl checked" data-id=\''+c+'\'><i class="iconfont icon-yixuanze"> '+c+"</i></li>"):n+='<li class="fl" data-id=\''+c+'\'><i class="iconfont icon-weixuanze"> '+c+"</i></li>"}n+="</ul></div>",n+='\n                    <div class="clearfix" style="padding:5px 0;">\n                        <ul class="fl legend clearfix">\n                            <li class="fl clearfix">\n                                <span class="fl">已排班：</span>\n                                <em class="checked fl"></em>\n                            </li>\n                            <li class="fl clearfix">\n                                <span class="fl">未排班：</span>\n                                <em class="not-checked fl"></em>\n                            </li>',n+="week"===t?'\n                        </ul>\n                        <button style="padding:12px; font-size:16px;" class="btn btn-primary fr" id="check-all-week-btn">全选'+s+"</button>\n                    </div>":'\n                            <li class="fl clearfix">\n                                <span class="fl">不出诊：</span>\n                                <em class="not-out fl"></em>\n                            </li>\n                        </ul>\n                        <button style="padding:12px; font-size:16px;" class="btn fr" id="check-date-60">60天</button>\n                        <button style="padding:12px; font-size:16px; margin:0 10px;" class="btn btn-primary fr" id="check-date-30">30天</button>\n                        <button style="padding:12px; font-size:16px;" class="btn fr" id="check-date-15">15天</button>\n                    </div>'}else n+='<p style="color:red;font-size:16px;">暂无数据或该员工没有绑定门店！</p>';i.tableWeek.children(".order-top").html(n),i.batchFn()}).then(function(){"week"===t?i.creatWeek():i.creatMonth(0,30)}).then(function(){setTimeout(function(){layer.close(layer.index)},100)}),this.tableWeek.on("click","#check-date-60",function(){e("#check-date-30").removeClass("btn-primary"),e("#check-date-15").removeClass("btn-primary"),e("#check-date-60").addClass("btn-primary"),o.toggleMonthTime(0,60,s(!0)),o.currentTime=60}),this.tableWeek.on("click","#check-date-30",function(){e("#check-date-60").removeClass("btn-primary"),e("#check-date-15").removeClass("btn-primary"),e("#check-date-30").addClass("btn-primary"),o.toggleMonthTime(0,30,s(!0)),o.currentTime=30}),this.tableWeek.on("click","#check-date-15",function(){e("#check-date-30").removeClass("btn-primary"),e("#check-date-60").removeClass("btn-primary"),e("#check-date-15").addClass("btn-primary"),o.toggleMonthTime(0,15,s(!0)),o.currentTime=15}),e(".cancel-order-time").on("click",n),e(".save-order-time").on("click",r),this.tableWeek.on("click","#check-all-week-btn",function(){console.log("checked all week"),o.setWeekOrder()}),this.tableWeek.on("click",".order-week-table td .content",a)},n.prototype.batchFn=function(){var t=this;this.tableWeek.on("click",".order-top .store-lists li",function(){var n=e(this);t.changeCheckedClass(n);var r=n.children("span").text(),s=n.children("span").attr("data-id");t.checkObj.id=s,t.checkObj.name=r,e("#check-all-week-btn").text("全选"+r)}),this.tableWeek.on("click",".order-top .order-date li",function(){var n=e(this);t.changeCheckedClass(n),t.canOderId=n.attr("data-id")})},n.prototype.changeCheckedClass=function(e){e.siblings().removeClass("checked"),e.siblings().children("i").removeClass("icon-yixuanze"),e.siblings().children("i").addClass("icon-weixuanze"),e.children("i").removeClass("icon-weixuanze"),e.addClass("checked"),e.children("i").addClass("icon-yixuanze")},n.prototype.toSaveOrder=function(e,t){var n=this,r={empid:this.currentId},s="";"week"===t?(r.weektime=e,s="saveWeekTime"):(r.date=e,r.time=this.currentTime,s="saveDayTime"),ajax(Api(s,r)).then(function(e){e.data&&(a.default.myLayer("保存成功！",1),n.cancel())})},n.prototype.setWeekOrder=function(){for(var t=e(".order-week-table td .content"),n=this.checkObj.name,r=this.checkObj.id,s=0;s<t.length;s++){var a=e(t[s]);a.attr("id",r),a.parent().removeClass("out not"),"-1"==r?(a.parent().addClass("not"),a.text("不出诊")):(a.parent().addClass("out"),a.text(n),a.siblings("em").text("("+this.canOderId+")"),a.siblings("em").attr("data-id",this.canOderId))}},n.prototype.setSingleOrder=function(t){var n=e(t.target);n.parent().removeClass("out not");var r=this.checkObj.name,s=this.checkObj.id;if(n.attr("id"))return n.empty(),n.siblings("em").empty(),n.attr("id",""),!1;s?(n.attr("id",s),"-1"==s?(n.parent().addClass("not"),n.text("不出诊")):(n.parent().addClass("out"),n.text(r),n.siblings("em").text("("+this.canOderId+")"),n.siblings("em").attr("data-id",this.canOderId))):a.default.myLayer("未选择排班对象！",2)},n.prototype.creatWeek=function(){var e=this;ajax(Api("getWeekTime",{empid:this.currentId})).then(function(e){return Promise.resolve(e)}).then(function(t){for(var n="\n            <tr>\n                <th>周一</th>\n                <th>周二</th>\n                <th>周三</th>\n                <th>周四</th>\n                <th>周五</th>\n                <th>周六</th>\n                <th>周日</th>\n            </tr>\n            <tr>",r=[1,2,3,4,5,6,0],s=t.data,a=0;a<r.length;a++){var i=e.renderTemplate("week",s,r[a]);n+='\n                <td>\n                    <em style="display:none;" name="week" class="day">'+r[a]+'</em>\n                    <span class="am '+i.amClass+'">\n                        <span class="time">上午</span>\n                        <p class="content" id="'+i.amId+'">'+i.amInner+'</p>\n                        <em class="order-time" data-id="'+i.amTimesId+'">'+i.amTimesIner+'</em>\n                    </span>\n                    <span class="pm '+i.pmClass+'">\n                        <span class="time">下午</span>\n                        <p class="content" id="'+i.pmId+'">'+i.pmInner+'</p>\n                        <em class="order-time" data-id="'+i.pmTimesId+'">'+i.pmTimesIner+"</em>\n                    </span>\n                </td>\n                "}n+="\n                </tr>\n                ",document.getElementsByClassName("order-week-table")[0].innerHTML=n})},n.prototype.creatMonth=function(){var t=this;e(".order-week-table").empty(),ajax(Api("getDayTime",{empid:this.currentId})).then(function(e){return Promise.resolve(e)}).then(function(e){t.monthData=e.data,t.renderMonthHtml(0,30,e.data)})},n.prototype.toggleMonthTime=function(e,t,n){if(n){for(var r=n,s=(new Date).getTime()+864e5*(this.currentTime-1),a=0;a<this.monthData.length;a++){var i=this.monthData[a];s<new Date(i.day).getTime()&&r.push(i)}this.renderMonthHtml(e,t,r)}},n.prototype.renderMonthHtml=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"order-week-table",s=arguments[4],a=" ",i=new Date,o=new Date(i.getTime()+864e5).getDay(),l=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],h=[],c=[];l.forEach(function(e,t){t>=o?h.push(e):c.push(e)}),a+="<tr>";for(var d=0;d<h.length;d++)a+="<th>"+h[d]+"</th>";for(var p=0;p<c.length;p++)a+="<th>"+c[p]+"</th>";a+="</tr>",a+=s?this.lookOrderStore(e,t,n):this.dateComplet(e,t,n),document.getElementsByClassName(r)[0].innerHTML=a},n.prototype.renderTemplate=function(e,t,n){var r="",s="",a="",i="",o="",l="",h="",c="",d="",p="";if(Array.isArray(t))for(var u=0;u<t.length;u++){var m=t[u];if(m[e]==n){m.am&&m.am.id&&(i=m.am.id,"-1"==m.am.id?(r="不出诊",a="not"):"-2"==m.am.id?(r="休店",a="not-rest"):(r=m.am.name,a="out",c=m.am.orderTimes?m.am.orderTimes:0,p="("+c+")")),m.pm&&m.pm.id&&(o=m.pm.id,"-1"==m.pm.id?(s="不出诊",l="not"):"-2"==m.pm.id?(s="休店",l="not-rest"):(h=m.pm.orderTimes?m.pm.orderTimes:0,l="out",s=m.pm.name,d="("+h+")"));break}}return{amInner:r,pmInner:s,amClass:a,amId:i,pmId:o,pmClass:l,amTimesId:c,pmTimesId:h,amTimesIner:p,pmTimesIner:d}},n.prototype.lookOrderStore=function(e,t,n){for(var r="",s=new Date,i=e;i<t;i++){var o=new Date(s.getTime()+864e5*(i+1)),l=a.default.fmtDate(o);i%7==0&&(r+="</tr><tr>");var h=[],c=[],d="",p="",u=!1;if(Array.isArray(n))for(var m=0;m<n.length;m++){var f=n[m];if(f.day==l){var v=f.am,y=f.pm;if("-2"==f.rest){u=!0,d="not-rest",p="not-rest";break}v.length>0&&(d="out",h=v),y.length>0&&(p="out",c=y);break}}if(r+='\n                <td class="look-oreder-lis-warp">\n                    <em name="day" class="day">'+l+'</em>\n                    <span class="look-oreder-lis am '+d+'">\n                        <span class="time">上午</span>\n                        <ul>\n            ',u)r+="休店";else for(var k=0;k<h.length;k++){var b=h[k];r+='<li data-id="'+b.id+'">'+b.name+'<em style="display:inline;">('+b.orderTimes+")</em></li>"}if(r+="</ul></span>",r+='\n                    <span class="look-oreder-lis pm '+p+'">\n                        <span class="time">下午</span>\n                        <ul>\n            ',u)r+="休店";else for(var g=0;g<c.length;g++){var w=c[g];r+='<li data-id="'+w.id+'">'+w.name+'<em style="display:inline;">('+w.orderTimes+")</em></li>"}r+="</ul></span>\n                    </span>\n                </td>\n            ",i===t-1&&(r+="</tr>")}return r},n.prototype.dateComplet=function(e,t,n){for(var r="",s=new Date,i=e;i<t;i++){var o=new Date(s.getTime()+864e5*(i+1)),l=a.default.fmtDate(o),h=this.renderTemplate("day",n,l);i%7==0&&(r+="</tr><tr>"),r+='\n                <td>\n                    <em name="day" class="day">'+l+'</em>\n                    <span class="am '+h.amClass+'">\n                        <span class="time">上午</span>\n                        <p class="content" id="'+h.amId+'">'+h.amInner+'</p>\n                        <em class="order-time" data-id="'+h.amTimesId+'">'+h.amTimesIner+'</em>\n                    </span>\n                    <span class="pm '+h.pmClass+'">\n                        <span class="time">下午</span>\n                        <p class="content" id="'+h.pmId+'">'+h.pmInner+'</p>\n                        <em class="order-time" data-id="'+h.pmTimesId+'">'+h.pmTimesIner+"</em>\n                    </span>\n                </td>\n            ",i===t-1&&(r+="</tr>")}return r},a.default.checkLogin().then(function(){a.default.getUserInfo();var t=t=new n(e("#order-table"),e("#order-week"));t.getOrder(),t.getDoctorList(),t.lookOrder()})})}).call(t,n(0))},function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function s(e){return"number"==typeof e}function a(e){return"object"==typeof e&&null!==e}function i(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!s(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,s,o,l,h;if(this._events||(this._events={}),"error"===e&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}if(n=this._events[e],i(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),n.apply(this,o)}else if(a(n))for(o=Array.prototype.slice.call(arguments,1),h=n.slice(),s=h.length,l=0;l<s;l++)h[l].apply(this,o);return!0},n.prototype.addListener=function(e,t){var s;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?a(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,a(this._events[e])&&!this._events[e].warned&&(s=i(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&s>0&&this._events[e].length>s&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),s||(s=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var s=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,s,i,o;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],i=n.length,s=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(a(n)){for(o=i;o-- >0;)if(n[o]===t||n[o].listener&&n[o].listener===t){s=o;break}if(s<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(s,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}}],[37]);