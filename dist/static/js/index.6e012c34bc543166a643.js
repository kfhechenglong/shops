webpackJsonp([2],{21:function(t,e,n){"use strict";var a=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"PHPSESSID",e=document.cookie.split("; "),n=0;n<e.length;n++){var a=e[n].split("=");if(t==a[0])console.log(unescape(a[1]));else{var i=window.document.location.href,o=i.split("/");o.pop(),o.push("login.html"),window.location.href=o.join("/")}}return null};t.exports={getCookie:a}},22:function(t,e){},4:function(t,e,n){"use strict";(function(t){function e(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}();n(1),n(2);var o=n(3),r=e(o),s=n(21);e(s);n(22),ajax("checksession","https://nx.smsc.net.cn/wxopen/app/shop/checksession.php/").then(function(t){console.log("登录成功状态！")}),t(document).ready(function(){function e(){ajax(Api("getCompanyInfo")).then(function(e){var n="";if(t("#header-info img").attr("src",e.data.headimg),t("#header-info .suerName").text(e.data.nickname),e){var a=e.data;n='<li class="list-group-item"><span>公司简称：</span><em>'+a.name+'</em></li><li class="list-group-item"><span>公司主体：</span><em>'+a.ownerid+"</em></li>";for(var i="",o=0;o<a.mp.minipro.length;o++){var s=a.mp.minipro[o],d=s.name?"i-selected":"";i+='\n                    <li class="list-group-item clearfix">\n                        <span class="fl"> '+s.vname+'：</span>\n                        <div class="fl minipro-list tc">\n                            <i class="iconfont icon-xiaochengxu '+d+'"></i> \n                            '+s.name+" \n                        </div>\n                    ","i-selected"!==d&&(i+='<div class="fr">\n                                <button id="bind-minipro" data-order="'+s.url+'" type="button" class="btn btn-primary" >绑定小程序</button>\n                            </div>'),i+="</li>"}n+=i;for(var l="",c=0;c<a.mp.fwh.length;c++){var m=a.mp.fwh[c],p=m.name?"i-selected":"";l+='\n                    <li class="list-group-item clearfix">\n                        <span class="fl"> '+m.vname+'：</span>\n                        <div class="fl minipro-list tc">\n                            <i class="iconfont icon-wechat '+p+'"></i> \n                            '+m.name+" \n                        </div>","i-selected"!==p&&(l+='<div class="fr">\n                                 <button id="bind-minipro" data-order="'+m.url+'" type="button" class="btn btn-primary" data-toggle="modal">绑定服务号</button>\n                            </div>'),l+="</li>"}n+=l,n+='\n                <li class="list-group-item">\n                    <span>加入时间：</span>\n                    <em>'+a.intime+'</em>\n                </li>\n                <li class="list-group-item">\n                    <span>更新时间：</span>\n                    <em>'+a.uptime+'</em>\n                </li>\n                <li class="list-group-item">\n                    <span>联系方式：</span>\n                    <em>'+a.contact+"</em>\n                </li>\n            "}else n="<p>暂无数据！</p>";r.default.addHtml(t(".list-company"),n)})}function n(){var e=(layer.load(2),"");ajax(Api("getEmpList")).then(function(n){var a=n.data,i=a.length;if(p=a,i>0){e+="<thead>< tr > <th>员工姓名</th> <th>员工类型</th> <th>联系方式</th> <th>更新时间</th> <th>加入时间</th>  <th>操作</th> </tr > </thead ><tbody>";for(var o=0;o<i;o++){var s=a[o];e+="\n                        <tr>\n                            <td>"+s.name+"</td>\n                            <td>"+s.usertype+"</td>\n                            <td>"+s.uptime+"</td>\n                            <td>"+s.intime+"</td>\n                            <td>"+s.contact+' </td>\n                            <td> \n                                <input type="hidden" value="'+s.id+'">\n                                <button class="btn btn-warning" id="employee-edit-btn">编辑</button>\n                                <button class="btn btn-danger" id="employee-delet-btn">删除</button>\n                            </td>\n                        </tr>\n                        '}e+="</tbody>"}else e="<p>暂无数据！</p>";r.default.addHtml(t(".employee-table"),e)})}function o(e,n){var a=t(this).parent().children("input").val(),i=function(){ajax(Api(e,{empid:a})).then(function(t){200===t.code?(r.default.myLayer("删除成功！",1),n()):r.default.myLayer("删除失败！",5)})};return r.default.myLayerTips("是否删除所选！",i)}window.addEventListener("message",function(n){if(console.log("from iframe....",n),n.data)try{var a=JSON.parse(n.data);console.log(a),200===a.code?(r.default.myLayer("绑定成功！",1),t("#myModal-company").modal("hide"),e()):r.default.myLayer("绑定失败,请重试！",2,3e3)}catch(t){r.default.myLayer("未知错误！",2)}},!1);var s=t(".employee"),d=t(".company"),l=t(".store"),c=t(".customer"),m={},p=[];t(".nav-company").on("click",function(){e(),d.show(),s.hide(),l.hide(),c.hide(),t(".order").hide()}),t(".nav-company").trigger("click");var u=Object.assign({name:{message:"公司名称不能为空",validators:{notEmpty:{message:"公司名称不能为空"},stringLength:{min:2,max:30,message:"公司名称长度不能小于2位或超过30位"},regexp:{regexp:/^[A-Za-z0-9\u4e00-\u9fa5]+$/,message:"公司名称只能由字母、数字、点和下划线组成。"}}},contact:{validators:{notEmpty:{message:"手机号码不能为空！"},regexp:{regexp:/^1\d{10}$/,message:"手机号码格式不正确。"}}}},{}),h=Object.assign(Object.assign({},r.default.validatorOptions),{fields:u});r.default.toggle(t("#edit"),t(".list-company"),t(".form-company"),h),d.on("click","#bind-minipro",function(e){var n=t(e.target).attr("data-order");ajax(null,n).then(function(e){if(e.data){t("#myModal-company").modal("show");var n='\n                    <div class="modal-body">\n                        <div style="width:700px; height:549px;margin:0 auto;position:relative">\n                            <div class="shade-top"></div>\n                            <iframe id="wxcode" src="'+e.data+'" frameborder="0" scrolling="no"  width="100%" height="100%;"></iframe>\n                            <div class="shade-bottom"></div>\n                        </div>\n                        \n                    </div>\n                ';t("#myModal-company-inner").empty(),t("#myModal-company-inner").append(n)}})}),t("#myModal-company").on("hidden.bs.modal",function(e){t("#myModal-company-inner").empty(),t("#myModal-company-inner").unbind("click")}),t("#company-submit").click(function(){var n=t(".form-company");if(n.bootstrapValidator("validate"),n.data("bootstrapValidator").isValid()){var a=n.serializeArray(),i={};a.forEach(function(t){i[t.name]=t.value}),ajax(Api("updateCompanyInfo",i)).then(function(a){n[0].reset(),e(),t("#edit").trigger("click"),t(".list-company").show(),n.hide()})}});var f=new Set;t(".nav-employee").on("click",function(){m.edit=!1,d.hide(),s.show(),l.hide(),c.hide(),t(".order").hide(),n();var e={url1:"getRoles",url2:"getStoreList",store:"#checkedStore",roles:"#checkedRoles",add_list:"#add-store-soles",dele_list:"delet-store-soles",warpul:"#bind-store ul",warp:"#bind-store",text:"店铺"};r.default.getSelectList(e,f)}),s.on("click","#employee-edit-btn",function(){var e=t(this).parent().children("input").val();t(".edit-employee").trigger("click"),ajax(Api("getEmp",{empid:e})).then(function(e){var n=e.data,a=t(".employee-form");a.find('input[name="name"]').val(n.name),a.find('input[name="contact"]').val(n.contact),a.find('input[name="usertype"]').val(n.usertype),m.edit=!0})}),s.on("click","#employee-delet-btn",function(){o("deletEmp",n)});var v=Object.assign(Object.assign({},r.default.validatorOptions),{fields:{name:{validators:{notEmpty:{message:"姓名不能为空"},stringLength:{min:2,max:30,message:"姓名长度不能小于2位或超过30位"},regexp:{regexp:/^[A-Za-z\u4e00-\u9fa5]+$/,message:"姓名只能由字母和汉字组成。"}}},pass:{validators:{notEmpty:{message:"密码不能为空！"},stringLength:{min:6,max:30,message:"密码长度不能小于6位或超过30位"},regexp:{regexp:/^[a-zA-Z0-9_\.]+$/,message:"密码只能由字母、数字和下划线。"}}},employeePasswordTwo:{validators:{notEmpty:{message:"密码不能为空！"},stringLength:{min:6,max:30,message:"密码长度不能小于6位或超过30位"},regexp:{regexp:/^[a-zA-Z0-9_\.]+$/,message:"密码只能由字母、数字和下划线。"},identical:{field:"pass",message:"两次输入密码不匹配"}}},contact:{validators:{notEmpty:{message:"手机号码不能为空！"},regexp:{regexp:/^1\d{10}$/,message:"手机号码格式不正确。"}}}}});r.default.toggle(t(".edit-employee"),t(".employee-table"),t(".employee-form"),v,m,"添加"),t(".edit-employee").on("click",function(){f.clear(),t("#bind-store").unbind("click"),t("#bind-store ul").empty(),t("#checkedRoles").selectpicker("refresh")});var y=t(".employee-form");t(".employee-btn-add").click(function(){if(console.log(m),y.bootstrapValidator("validate"),y.data("bootstrapValidator").isValid()){var e=y.serializeArray(),a={};e.forEach(function(t){"employeePasswordTwo"!==t.name&&(a[t.name]=t.value)});var i="addEmp";m.edit&&(i="updateEmp",a=Object.assign(a,{empid:2}));var o=r.default.getSelectedValue();a=Object.assign(a,{typeRoles:o}),ajax(Api(i,a)).then(function(e){e?(y[0].reset(),n(),t(".edit-employee").trigger("click")):r.default.myLayer("请求失败！",5)})}});var b=[],g=!1,w="",k=new Set,x=new Set,L=function(){ajax(Api("getStoreList")).then(function(e){if(e){var n=e.data;b=n;var a=n.length,i="";if(a>0){i+="<thead>< tr > <th>序号</th> <th>店名</th><th>操作员</th> <th>联系方式</th><th>地址</th><th>二维码</th><th>休店</th><th>操作</th> </tr > </thead ><tbody>";for(var o=0;o<a;o++){var r=n[o];if(i+="\n                        <tr>\n                            <td>"+(o+1)+"</td>\n                            <td>"+r.name+"</td>\n                            <td>\n                        ",r.operator_ids)for(var s=r.operator_ids,d=0;d<s.length;d++){var l=s[d];i+="<p>"+l.name+"</p>"}i+="</td>\n                            <td>"+r.contact+" </td>\n                            <td>"+r.input_province+r.input_city+r.input_area+r.addr_detail+'</td>\n                            <td> \n                                <button data-id="'+r.qrcode+'" class="btn btn-primary" id="store-code-btn">获取</button>\n                            </td>\n                            <td> \n                                <button data-id="'+r.id+'" class="btn btn-primary" id="store-rest-btn">设置</button>\n                            </td>\n                            <td> \n                                <input type="hidden" value="'+r.id+'">\n                                <button class="btn btn-warning" id="store-edit-btn">编辑</button>\n                                <button class="btn btn-danger" id="store-delet-btn">删除</button>\n                            </td>\n                        </tr>\n                        '}i+="</tbody>"}else i="<p>暂无数据！</p>";var c=t(".store-table");c.empty(),c.append(i)}})},j=function(){l.show(),d.hide(),s.hide(),c.hide(),t(".order").hide(),L()},_={validators:{callback:{message:"当前项不能为空！",callback:function(t,e){return 0!=t}}}},C=Object.assign(Object.assign({},r.default.validatorOptions),{fields:{name:{validators:{notEmpty:{message:"店名不能为空"},stringLength:{min:2,max:30,message:"店名长度不能小于2位或超过30位"},regexp:{regexp:/^[0-9A-Za-z\u4e00-\u9fa5]+$/,message:"店名只能由字母、数字、汉字组成。"}}},input_province:_,input_city:_,addr_detail:_,contact:{validators:{notEmpty:{message:"联系方式不能为空！"},regexp:{regexp:/^[0-9]+$/,message:"只能是数字！"}}}}}),A=function(e,n){t(".store-table").hide(),t(".store-form").show(),t(".add-store").hide(),t(".off-store").show();t("#map-warp").empty(),t("#map-warp").append('\n            <div id="store-map" style="width:100%;height:300px;"></div>'),t(".store-form").bootstrapValidator(C);var a={url1:"getRoles",url2:"getEmpList",store:"#select-store-id",roles:"#select-store-roles",add_list:"#add-store-soles-2",dele_list:"delet-store-soles-list",warpul:"#bind-em-roles ul",warp:"#bind-em-roles",text:"员工"};r.default.getSelectList(a,x)},E=function(){g=!1,r.default.clearFormContent(t(".store-form")),t(".store-form").data("bootstrapValidator").destroy(),t(".store-form").data("bootstrapValidator",null),t(".store-table").show(),t(".store-form").hide(),t(".add-store").show(),t(".off-store").hide()};t(".nav-store").on("click",j),t(".add-store").on("click",A),t(".off-store").on("click",E),l.on("click","#store-rest-btn",function(){t("#myModal-company").modal("show");t("#myModal-company-inner").empty(),t("#myModal-company-inner").append('\n            <div class="modal-body">\n                <div class="clearfix">\n                    <div class="fl wx-code tc">\n                        选择时间\n                        <div class="input-group date">\n                            <input id="datetimepicker" type="text" class="form-control" >\n                        </div>\n                    </div>\n                    <div class="em-list fl">\n                    </div>\n                </div>\n                <p class="tc">\n                    <span style="color:red">提示：</span>\n                    <em style="color: darkblue;">请现在该店休店时间！</em>\n                </p>\n            </div>\n        '),t("#datetimepicker").datetimepicker({language:"zh-CN",format:"yyyy-mm-dd",timepicker:!0,autoclose:!1,startView:2,minView:2,todayBtn:!0})}),l.on("click","#store-code-btn",function(){k.clear(),t("#myModal-company").modal("show");var e=t(this).attr("data-id"),n='\n            <div class="modal-body">\n                <div class="clearfix">\n                    <div class="fl wx-code tc">\n                        <p class="tc">二维码<p>\n                        <img class="" src="'+e+'" title="二维码">\n                        <a href="'+e+'" download="下载二维码" class="btn btn-info active" role="button">下载保存</a>\n                    </div>\n                    <div class="em-list fl">\n                    </div>\n                </div>\n                <p class="tc">\n                    <span style="color:red">提示：</span>\n                    <em style="color: darkblue;">可以选择员工发送二维码，也可下载到本地！</em>\n                </p>\n            </div>\n        ';t("#myModal-company-inner").empty(),t("#myModal-company-inner").append(n),ajax(Api("getEmpList")).then(function(e){var n=e.data;if(n){for(var a='<p class="tc">员工列表<p><ul>',i=0;i<n.length;i++){var o=n[i];a+='<li  class="list-group-item em-lis fz16" data-id="'+o.id+'">'+o.name+"</li>"}a+='</ul>\n                <button type="button" class="fr btn btn-info send-em-code on">确定发送</button>\n                ',t("#myModal-company .modal-body .em-list").empty(),t("#myModal-company .modal-body .em-list").append(a),t("#myModal-company-inner").on("click",".em-lis",function(){t(this).toggleClass("active");var e=t(this).attr("data-id");k.has(e)?k.delete(e):k.add(e),console.log(k)})}else r.default.myLayer("获取员工列表出错！",5)})}),l.on("click","#store-delet-btn",function(){o("deletStore",L)}),l.on("click","#store-edit-btn",function(){g=!0,w=t(this).parent().children("input").val();for(var e={},n=0;n<b.length;n++){var a=b[n];if(w==a.id){e=Object.assign({},a);break}}e.operator_ids.map(function(t){return t.id});ajax(Api("getStore",{storeid:w})).then(function(t){});var i=t(".store-form");i.find('input[name="name"]').val(e.name),i.find('input[name="contact"]').val(e.contact),i.find('input[name="input_province"]').val(e.input_province),i.find('input[name="input_city"]').val(e.input_city),i.find('input[name="input_area"]').val(e.input_area),i.find('input[name="addr_detail"]').val(e.addr_detail),A()});var M=function(){if(t(".store-form").bootstrapValidator("validate"),t(".store-form").data("bootstrapValidator").isValid()){for(var e=t(".store-form").serializeArray(),n=[],a={},i="addStore",o=0;o<e.length;o++){var s=e[o];"select-store-all"===s.name?n.push(s.value):a[s.name]=s.value}a.operator_ids=n,g&&(a.storeid=w,i="gudateStore");var d=r.default.getSelectedValue("#bind-em-roles ul li");a=Object.assign(a,{typeRoles:d}),ajax(Api(i,a)).then(function(t){t&&(r.default.myLayer("添加成功！",1),E(),L())})}};t(".store-btn-add").click(M);var S=function(){function e(t,n,i,o){a(this,e),this.form=t,this.table=n,this.off=i,this.add=o,this.customerIsEdit=!1}return i(e,[{key:"showOrder",value:function(){c.show(),l.hide(),d.hide(),s.hide(),t(".order").hide(),t(".off-customer").trigger("click")}}]),e}();S.prototype.getCustomerList_fn=function(){var e=this,n=(layer.load(2),this);this.add.on("click",function(){n.addNewCustomer()}),t(".customer-btn-add").on("click",function(){n.addNewCustomerBtn()}),this.off.on("click",function(){n.offNewCustomer()}),ajax(Api("getCustomerList")).then(function(t){if(t.data){var a=t.data,i=a.length;e.customerList=a;var r="";if(i>0){r+="<thead>< tr > <th>客户姓名</th> <th>微信</th> <th>微信电话</th><th>联系方式</th><th>绑定电话</th><th>更新时间</th> <th>加入时间</th>  <th>二维码</th>  <th>操作</th> </tr > </thead ><tbody>";for(var s=0;s<i;s++){var d=a[s];r+="\n                        <tr>\n                            <td>"+d.name+"</td>\n                            <td>"+d.wxuid+"</td>\n                            <td>"+d.wxphone+"</td>\n                            <td>"+d.contact+"</td>\n                            <td>"+d.bind_phone+"</td>\n                            <td>"+d.uptime+"</td>\n                            <td>"+d.intime+'</td>\n                            <td> \n                                <button data-qrcode="'+d.qrcode+'" class="btn btn-info" id="customer-show-code-btn">二维码</button>\n                                <button data-id="'+d.id+'" class="btn btn-danger" id="customer-show-clear-btn">清除</button>\n                            </td>\n                            <td> \n                                <input type="hidden" value="'+d.id+'">\n                                <button class="btn btn-warning" id="customer-edit-btn">编辑</button>\n                            </td>\n                        </tr>\n                        '}r+="</tbody>"}else r="<p>暂无数据！</p>";e.table.empty(),e.table.append(r),c.on("click","#customer-delet-btn",function(){o("deletStore",n.getCustomerList_fn)}),c.on("click","#customer-edit-btn",function(){n.editCustomer(this)}),c.on("click","#customer-show-code-btn",function(){n.showCode(this)}),c.on("click","#customer-show-clear-btn",function(){n.clearCode(this)})}})},S.prototype.clearCode=function(e){ajax(Api("clearCode",{customerid:t(e).attr("data-id")})).then(function(t){r.default.myLayer("清除成功！",1)})},S.prototype.showCode=function(e){var n=t(e).attr("data-qrcode");t("#myModal-company").modal("show");var a='\n                <div class="modal-body">\n                    <div style="width:450px; height:450px;margin:0 auto;">\n                        <iframe id="wxcode" src="'+n+'" frameborder="0" scrolling="no"  width="100%" height="100%;"></iframe>\n                    </div>\n                    \n                </div>\n            ';t("#myModal-company-inner").empty(),t("#myModal-company-inner").append(a)},S.prototype.addNewCustomer=function(){this.add.hide(),this.off.show(),this.table.hide(),this.form.show()},S.prototype.editCustomer=function(e){this.customerIsEdit=!0,this.add.trigger("click");for(var n=t(e).parent().children("input").val(),a={},i=0;i<this.customerList.length;i++){var o=this.customerList[i];if(n==o.id){a=Object.assign({},o);break}}var r=this.form;r.find('input[name="id"]').val(n),r.find('input[name="name"]').val(a.name),r.find('input[name="contact"]').val(a.contact),r.find('input[name="bind_phone"]').val(a.bind_phone)},S.prototype.addNewCustomerBtn=function(){var t=this,e=this.form.serializeArray(),n={},a="addCustomer",i="添加成功！";this.customerIsEdit&&(a="updateCustomer",i="更新成功！",n.customerid=e.id);for(var o=0;o<e.length;o++){var s=e[o];n[s.name]=s.value}ajax(Api(a,n)).then(function(e){e?(r.default.myLayer(i,1),t.off.trigger("click"),t.getCustomerList_fn()):r.default.myLayer("操作失败！",5)})},S.prototype.offNewCustomer=function(){this.customerIsEdit=!1,this.off.hide(),this.add.show(),this.table.show(),this.form.hide(),t(":input",this.form).val("")},t(".nav-customer").on("click",function(){var e=new S(t(".customer-form"),t(".customer-table"),t(".off-customer"),t(".add-customer"));return e.showOrder(),e.getCustomerList_fn(),!1});var O=function(){function e(t,n){a(this,e),this.tableList=t,this.tableWeek=n}return i(e,[{key:"getOrder",value:function(){this.showOrder()}},{key:"showOrder",value:function(){t(".order").show(),c.hide(),l.hide(),d.hide(),s.hide(),this.cancel()}}]),e}();O.prototype.getDoctorList=function(){var e=this,n=this;ajax(Api("getEmpList")).then(function(a){var i="",o=a.data,r=o.length;if(e.doctorList=o,r>0){i+="<thead><tr> <th>序号</th><th>员工姓名</th><th>角色</th><th>排班</th> </tr > </thead><tbody>";for(var s=0;s<r;s++){var d=o[s];i+="\n                        <tr>\n                            <td>"+(s+1)+"</td>\n                            <td>"+d.name+"</td>\n                            <td>"+d.usertype+'</td>\n                            <td> \n                                <input type="hidden" value="'+d.id+'">\n                                <button class="btn btn-warning" id="order-week-btn">按周</button>\n                                <button class="btn btn-danger" id="order-month-btn">按天</button>\n                            </td>\n                        </tr>\n                        '}i+="</tbody>"}else i="<p>暂无数据！</p>";var l=e.tableList;l.empty(),l.append(i);var c=function(){n.currentId=t(this).parent().children("input").val(),n.selectList("week")},m=function(){n.currentId=t(this).parent().children("input").val(),n.selectList("month")};e.tableList.unbind("click"),e.tableList.on("click","#order-week-btn",c),e.tableList.on("click","#order-month-btn",m)})},O.prototype.getStoreList=function(){var e=this;return new Promise(function(n,a){ajax(Api("getStoreList")).then(function(a){var i='\n                    <label class="checkbox-inline">\n                        <input name="checkStore" type="radio" value="-1">不出诊\n                    </label>\n                ',o=a.data,r=o.length;if(e.storeList=o,r>0)for(var s=0;s<r;s++){var d=o[s];i+='\n                        <label class="checkbox-inline">\n                                <input name="checkStore" type="radio" value="'+d.id+'">'+d.name+"\n                            </label>\n                            "}else i="<p>暂无数据！</p>";var l=t(".order-week-inner-form");l.empty(),l.append(i),n(o)})})},O.prototype.cancel=function(){this.tableList.show(),this.tableWeek.hide(),t(".save-order-time").unbind("click"),t(".cancel-order-time").unbind("click"),t(".order-week-modal-on").unbind("click"),t("#order-week").unbind("click")},O.prototype.selectList=function(e){function n(){r.cancel()}function a(){for(var n=t(".order-week-table td"),a=[],i=0;i<n.length;i++){var o=n[i],s=t(o).children(".day"),d=t(o).children(".am").children(".content").attr("id"),l=t(o).children(".pm").children(".content").attr("id");if(d||l){var c={am:d||"",pm:l||""};c[s.attr("name")]=s.text(),a.push(c)}}r.toSaveOrder(a,e)}function i(t){l=t.target,r.showModal(t)}var o=this,r=this;this.tableList.hide(),this.tableWeek.show();for(var s=0;s<this.doctorList.length;s++){var d=this.doctorList[s];if(d.id===this.currentId){this.name=d.name;break}}this.tableWeek.children("p").html("<p>当前医生："+this.name+"</p>"),"week"===e?this.creatWeek():this.creatMonth(),t(".cancel-order-time").on("click",n),t(".save-order-time").on("click",a);var l="";this.getStoreList().then(function(t){o.tableWeek.on("click",".order-week-table td .content",i)}),t(".order-week-modal-on").on("click",function(){for(var e="",n=t(".order-week-inner-form").serializeArray()[0].value,a=0;a<r.storeList.length;a++){var i=r.storeList[a];if(n==i.id){e=i.name;break}}t(l).empty(),t(l).attr("id",""),t(l).attr("id",n),"-1"==n?(t(l).parent().addClass("not"),t(l).text("不出诊")):(t(l).parent().addClass("out"),t(l).text(e))})},O.prototype.toSaveOrder=function(t,e){var n=this;if(0===t.length)return r.default.myLayer("请选择内容",2),!1;var a={empid:this.currentId},i="";"week"===e?(a.weektime=t,i="saveWeekTime"):(a.date=t,i="saveDayTime"),ajax(Api(i,a)).then(function(t){t.data&&(r.default.myLayer("保存成功！",1),n.cancel())})},O.prototype.showModal=function(e){var n=e.target;if(t(n).parent().removeClass("out not"),t(n).html())return t(n).empty(),t(n).attr("id",""),!1;t("#myModal-order").modal("show")},O.prototype.creatWeek=function(){t(".order-week-table").empty(),ajax(Api("getWeekTime",{empid:this.currentId})).then(function(t){return Promise.resolve(t)}).then(function(t){for(var e="\n            <tr>\n                <th>周一</th>\n                <th>周二</th>\n                <th>周三</th>\n                <th>周四</th>\n                <th>周五</th>\n                <th>周六</th>\n                <th>周日</th>\n            </tr>\n            <tr>",n=[1,2,3,4,5,6,0],a=t.data,i=0;i<n.length;i++){var o="",r="",s="",d="",l="",c="";if(Array.isArray(a))for(var m=0;m<a.length;m++){var p=a[m];if(p.week==n[i]){p.am.id&&(d=p.am.id,"-1"==p.am.id?(o="不出诊",s="not"):(o=p.am.name,s="out")),p.pm.id&&(l=p.pm.id,"-1"==p.pm.id?(r="不出诊",c="not"):(c="out",r=p.pm.name));break}}e+='\n                <td>\n                    <em style="display:none;" name="week" class="day">'+n[i]+'</em>\n                    <span class="am '+s+'">\n                        <span class="time">上午</span>\n                        <p class="content" id="'+d+'">'+o+'</p>\n                    </span>\n                    <span class="pm '+c+'">\n                        <span class="time">下午</span>\n                        <p class="content" id="'+l+'">'+r+"</p>\n                    </span>\n                </td>\n                "}e+="\n                </tr>\n                ",document.getElementsByClassName("order-week-table")[0].innerHTML=e})},O.prototype.creatMonth=function(){var e=" ",n=new Date,a=new Date(n.getTime()).getDay(),i=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],o=[],r=[];i.forEach(function(t,e){e>=a?o.push(t):r.push(t)}),e+="<tr>";for(var s=0;s<o.length;s++)e+="<th>"+o[s]+"</th>";for(var d=0;d<r.length;d++)e+="<th>"+r[d]+"</th>";e+="</tr>",ajax(Api("getDayTime",{empid:this.currentId})).then(function(t){return Promise.resolve(t)}).then(function(t){});for(var l=0;l<30;l++){var c=new Date(n.getTime()+864e5*l).toLocaleDateString();l%7==0&&(e+="</tr><tr>"),e+='\n                <td>\n                    <em name="day" class="day">'+c+'</em>\n                    <span class="am">\n                        <span class="time">上午</span>\n                        <p class="content"></p>\n                    </span>\n                    <span class="pm">\n                        <span class="time">下午</span>\n                        <p class="content"></p>\n                    </span>\n                </td>\n            ',29===l&&(e+="</tr>")}t(".order-week-table").empty(),document.getElementsByClassName("order-week-table")[0].innerHTML=e};var V="";t(".nav-order").on("click",function(){r.default.checkType(V,"Object")||(V=new O(t("#order-table"),t("#order-week"))),V.getOrder(),V.getDoctorList()})}),t(document).ready(function(){function e(){var t=function(){ajax("loginout","https://nx.smsc.net.cn/wxopen/app/shop/logout.php/").then(function(t){console.log("退出登录成功！",t)})};return r.default.myLayerTips("是否退出？",t,"取消","确定")}t("#loginout").on("click",e)})}).call(e,n(0))}},[4]);